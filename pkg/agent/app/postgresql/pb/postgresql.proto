syntax = "proto3";

package postgresql;
option go_package="github.com/upmio/unit-operator/pkg/agent/app/postgresql";

import "pkg/agent/app/common/pb/common.proto";

enum LogicalBackupMode {
  Full = 0;
  Database = 1;
  Table = 2;
}

message LogicalBackupRequest {
  string backup_file = 1;
  string username = 2;
  string database = 3;
  string table = 4;
  LogicalBackupMode logical_backup_mode = 5;
  common.ObjectStorage object_storage = 6;
}

message PhysicalBackupRequest {
  string backup_file = 1;
  string username = 2;
  common.ObjectStorage object_storage = 3;
}

message RestoreRequest {
  string backup_file = 1;
  common.ObjectStorage object_storage = 2;
}

message SetVariableRequest {
  string key = 1;
  string value = 2;
  string username = 3;
}

service PostgresqlOperation {
  rpc PhysicalBackup (PhysicalBackupRequest) returns (common.Empty);
  rpc LogicalBackup (LogicalBackupRequest) returns (common.Empty);
  rpc Restore (RestoreRequest ) returns (common.Empty);
  rpc SetVariable (SetVariableRequest) returns (common.Empty);
}